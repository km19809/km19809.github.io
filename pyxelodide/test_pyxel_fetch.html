<!-- Bootstrap HTML for running the unit tests. -->
<!DOCTYPE html>
<html>
  <head>
    <title>pyodide</title>
    <script type="text/javascript">
      window.logs = [];
      console.log = function (message) {
        window.logs.push(message);
      };
      console.warn = function (message) {
        window.logs.push(message);
      };
      console.info = function (message) {
        window.logs.push(message);
      };
      console.error = function (message) {
        window.logs.push(message);
      };
    </script>
    <script src="./pyodide.js"></script>
  </head>
  <body>
    <canvas id="canvas" oncontextmenu="event.preventDefault()"></canvas>
    <script type="text/javascript">
      async function main(){
        const filename = (new URLSearchParams(location.search)).get("py") || "08_triangle_api"
        const pyodide = await loadPyodide();
        await pyodide.loadPackage("micropip")
        const micropip = pyodide.pyimport("micropip")
        await micropip.install("pyxel-1.8.0-cp37-abi3-emscripten_3_1_14_wasm32.whl")
        const response = await fetch(`python/${filename}.py`)
        if (response.status != 200)
        {
          pyodide.runPython(await (await fetch("python/00_moving_square.py")).text())
        }
        else {
          pyodide.runPython(await response.text())
        }
      }
      main()
    </script>
  </body>
</html>
